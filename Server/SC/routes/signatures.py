from flask_restful import Resource, reqparse
from SC.controllers.authenticate_api_key import authenticate_api_key
from SC.controllers.add_sig_to_db import add_sig_to_db
from SC.controllers.get_sig_from_db import get_sig_from_db

post_req_args = reqparse.RequestParser()
post_req_args.add_argument("signatures", type=str, action="append", help="Signature List Is Required", required=True)


class Upload_Download_Signatures(Resource):
	@authenticate_api_key
	def get(self):
		return get_sig_from_db()

	@authenticate_api_key	
	def post(self):
		args = post_req_args.parse_args()
		sig = args["signatures"]
		return add_sig_to_db(sig)
		
