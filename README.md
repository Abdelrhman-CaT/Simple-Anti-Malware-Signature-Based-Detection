<h2 align="center">&lt;SIMPLE ANTI-MALWARE USING SIGNATURE-BASED DETECTION&gt;</h2>

<!-- TABLE OF CONTENTS -->
<h2 align="center">Table of Contents</h2>

- [About the Project](#about-the-project)
   - [Built With](#built-with)
- [Installation](#installation)
- [Contributers](#contributers)

<!-- ABOUT THE PROJECT -->

<h2 align="center">About The Project</h2>

> A simple command-line program simulating anti-malware with signature based technique.

<p align="center">
   <img src="dashboard.png" alt="program" title="Program" height=330 width=600/>
</p>

<h3><b>OP1</b>: Add a SHA-256 Signature to The Database</h3>

- Given an input string representing a SHA-256 digest. 
- The program removes spaces _if any_ from the input string. 
- The program calculates the length of the resulting string. 
- If the length is not equal to 64, then the input is considered invalid. 
- If the length is equal to 64, the resulting string is added to the signatures database.
- If the resulting string already exists in the database, the database will return an error indicating that the UNIQUE constraint is violated.
- If the resulting string doesn't exist in the database, then it is added successfully to the database.


<h3><b>OP2</b>: Delete a Signature from The Database</h3>

- Given an input string representing a SHA-256 digest. 
- The database applies delete operation to the matching signature.


<h3><b>OP3</b>: Scan The Processes of The System</h3>

- The program lists all the currently running processes in the system. 
- The program identifies the executable behind each process. 
- The program calculates the SHA-256 digest for each executable. 
- For each SHA-256 digest produced, the database checks if there is a matching signature stored in it.
- If there isn't a matching signature, then the executable is declared clean. 
- If there is a matching signature, then the executable is declared malicious and the corresponding process is terminated.
- At the end of the scanning process, a scanning summary appears. 
- The summary includes: 
    1. Total number of the programs scanned. 
    2. Number of clean programs. 
    3. Number of malicious programs detected. 
    4. Number of malicious programs terminated.


<h3><b>OP4</b>: Get The Hash Value of a Specific File</h3>

- Given a string representing the path to a file in the system. 
- The program checks if the input string is a real path to a real file in the system.
- If the checks fail, the input is considered invalid. 
- If the checks passed, the program returns the SHA-256 digest for the file identified by input path.


<h3><b>OP5</b>: Mark a File As a Virus</h3>

- Given a string representing the path to a file in the system. 
- The program checks if the input string is a real path to a real file in the system.
- If the checks fail, the input is considered invalid. 
- If the checks passed, the program calculates the SHA-256 digest for the file and store it in the database.


<h3><b>OP6</b>: Unmark a File from Being a Virus</h3>

- Given a string representing the path to a file in the system. 
- The program checks if the input string is a real path to a real file in the system.
- If the checks fail, the input is considered invalid. 
- If the checks passed, the program calculates the SHA-256 digest for the file and delete the matching signature from the database.


<h3><b>OP7</b>: Scan a Certain File</h3>

- Given a string representing the path to a file in the system. 
- The program checks if the input string is a real path to a real file in the system.
- If the checks fail, the input is considered invalid. 
- If the checks passed, the program calculates the SHA-256 digest for the file and check if there is a matching signature in the database.
- If there isn't a matching signature, then the file is declared clean. 
- If there is a matching signature, then the file is declared malicious. 
- For each malicious file, the program checks if there are any currently running processes run by that file.
- If there are processes run by that file, they are terminated.


<h3><b>OP8</b>: Scan The Newly Created / Modified Files Within The Past X Minutes</h3>

- The program asks the user about how much time passed since the file is created of last modified to be considered new.
- The user replies specifying the number of minutes. 
- The input specified by the user should be a positive numerical value which can either be an integer such as 5 or a floating-point value such as 0.5 or 3.5 and so on.
- Use floating-point values to represent number of minutes along with fractions of the minute (seconds)
- Let us suppose the user input is x minutes. (x can be either integer of floating-point number)
- The program lists all the files that are created or last-modified in the past x minutes.
- For each file in the list, the program calculates the SHA-256 digest and compare it with the signatures stored in the database.
- If there is no match, the file is declared clean. 
- If there is a match, the file is declared malicious. 
- For each malicious file, the program checks if there are any currently running processes run by that file.
- If there are processes run by that file, they are terminated. 
- At the end of the scanning process, a scanning summary appears. 
- The summary includes: 
    1. Total number of the files scanned. 
    2. Number of clean files. 
    3. Number of malicious files detected. 
    4. Number of malicious files having currently-running processes. 
    5. Number of malicious files having no currently-running processes. 
    6. Number of malicious files having their currently-running processes terminated.
    7. Number of malicious files having their currently-running processes not terminated.


<h3><b>OP9</b>: Monitor and Scan New Files As Soon As They Are Created</h3>

- The user specifies the directory which he/she wants to monitor.
- As soon as a new file appears, the program waits until there are no other processes using that file.
- The program scans the file.
- If the file is malicious, the program declares the file to be malicious
- For each malicious file, terminate the processes which are run by that file (if any).
- If the file is clean, the program declares the file to be clean.



<h3><b>OP10</b>: Exit</h3>

- The program breaks the while loop and exits. 
- When the program exits, an exit handling function is executed printing the message Bye!


<!-- BUILT WITH -->  
<h2 align="center">Built With</h2>

> The program is mainly built with Python 3.6.9 and SQLite 3 on Ubuntu 18.04.6 LTS

<p align="center">
   <a href="https://www.python.org/"><img src="https://img.shields.io/badge/3.6.9%20-%23?color=green&style=flat&label=Python"/></a>
   <a href="https://www.sqlite.org/index.html"><img src="https://img.shields.io/badge/3%20-%23?color=green&style=flat&label=SQLite"/></a>
</p> 

<!-- INSTALLATION -->
<h2 align="center">Installation</h2>

1. Clone this repository  

```
  git clone <repo_link>
  cd <repo>
```  

2. Install the required package for building the executables

```
  pip install pyinstaller
```  

3. Build the scanner into an executable

```
  cd scanner
  pyinstaller --onefile Virus_Scanner.py
  cd dist
  sudo ./Virus_Scanner
```  

4. Build the virus into an executable

```
  cd virus
  pyinstaller --onefile virus.py
  cd dist
  ./virus
```  

<!-- CONTRIBUTERS -->

<h2 align="center">Contributers</h2>

 <!--Contributers will be visible when the repo becomes public.-->

<a href="https://github.com/Abdelrhman-CaT/Simple-Anti-Malware-Signature-Based-Detection/graphs/contributors">
    
  <img src="https://contributors-img.web.app/image?repo=Abdelrhman-CaT/Simple-Anti-Malware-Signature-Based-Detection"/>
</a>